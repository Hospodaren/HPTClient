<HPT:UCMarkBetControl x:Class="HPTClient.UCGroupIntervalReduction"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
             mc:Ignorable="d" 
             x:Name="ucGroupIntervalReduction"
             xmlns:HPT="clr-namespace:HPTClient">
    <Grid>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition/>
            </Grid.RowDefinitions>

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                <StackPanel.Resources>
                    <Style TargetType="{x:Type Button}">
                        <Setter Property="Padding" Value="3"/>
                        <Setter Property="Margin" Value="2"/>
                        <Setter Property="MinWidth" Value="60"/>
                        <Setter Property="Height" Value="25"/>
                    </Style>
                    <Style TargetType="{x:Type Border}">
                        <Setter Property="Margin" Value="2"/>
                        <Setter Property="BorderThickness" Value="1"/>
                        <Setter Property="BorderBrush" Value="DarkBlue"/>
                        <Setter Property="CornerRadius" Value="1"/>
                    </Style>
                </StackPanel.Resources>

                <Border>
                    <StackPanel Orientation="Horizontal">
                        <CheckBox x:Name="chkUseGroupIntervalReduction" Content="Använd gruppintervall"
                                  TextElement.FontSize="12" TextElement.Foreground="Black" VerticalAlignment="Center"
                                  IsChecked="{Binding Path=GroupIntervalRulesCollection.Use}" Margin="2"/>
                        <Button x:Name="btnNewRule" Click="btnNewRule_Click" Content="Ny regel"/>
                        <Button x:Name="btnRemoveAll" Click="btnRemoveAll_Click" Content="Ta bort alla"/>
                    </StackPanel>
                </Border>

                <Border>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Style="{StaticResource tbMediumStyle}" Text="Antal gruppintervallregler" FontSize="12" Padding="2"/>

                        <ItemsControl x:Name="itNumberOfGroupIntervalRules" ItemsSource="{Binding Path=GroupIntervalRulesCollection.NumberOfWinnersList}" 
                                  Margin="2" ToggleButton.Checked="itNumberOfGroupIntervalRules_Checked" ToggleButton.Unchecked="itNumberOfGroupIntervalRules_Checked">
                            <ItemsControl.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <StackPanel Orientation="Horizontal"/>
                                </ItemsPanelTemplate>
                            </ItemsControl.ItemsPanel>
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <CheckBox Template="{StaticResource CheckBoxTemplate}" 
                                                      Content="{Binding NumberOfWinners}" 
                                                      IsChecked="{Binding Selected}" 
                                                      IsEnabled="{Binding Selectable}"
                                                      FontSize="12"
                                                      Width="13"
                                                      Height="16"/>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </Border>

                <Border>
                    <StackPanel Orientation="Horizontal">
                        <TextBlock x:Name="tbUseTemplate" Text="Välj mall" Margin="2" VerticalAlignment="Center" FontSize="12" Foreground="Black"/>
                        <ComboBox x:Name="cmbGroupIntervalRulesCollection" DisplayMemberPath="Name"
                                  ItemsSource="{Binding Path=GroupIntervalRulesCollectionList}" Margin="2" Width="100"/>
                        <Button x:Name="btnSelectTemplate" Content="OK" Click="btnSelectTemplate_Click"/>
                    </StackPanel>
                </Border>

                <Border>
                    <StackPanel Orientation="Horizontal">
                        <TextBox x:Name="txtNewTemplateName" Margin="2" VerticalAlignment="Center" Text="{Binding Name}" Width="200"/>
                        <Button x:Name="btnSaveAsTemplate" Click="btnSaveAsTemplate_Click" Content="Spara som mall"/>
                    </StackPanel>
                </Border>

            </StackPanel>

            <ListView Name="lvwGroupIntervalRules" ItemsSource="{Binding Path=GroupIntervalRulesCollection.ReductionRuleList}" 
                      Grid.Row="1" BorderThickness="0"
                      ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto">

                <ListView.Resources>
                    <Style TargetType="{x:Type GridViewColumnHeader}">
                        <Style.Setters>
                            <Setter Property="BorderBrush" Value="Black"/>
                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                            <Setter Property="Background" Value="{StaticResource HeaderGrayBrush}"/>
                        </Style.Setters>
                    </Style>

                    <Style TargetType="{x:Type ListViewItem}">
                        <Setter Property="Background" Value="{StaticResource StandardBrush}"/>
                        <Setter Property="BorderBrush" Value="Black"></Setter>
                        <Setter Property="BorderThickness" Value="0.5"></Setter>
                        <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                        <Setter Property="Margin" Value="1"/>
                    </Style>

                </ListView.Resources>

                <ListView.View>
                    <GridView x:Name="gvwGroupIntervalReductionRules">

                        <GridViewColumn x:Name="gvcUseRule">
                            <GridViewColumnHeader ToolTipService.ToolTip="Klicka för att använda regel"/>
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <CheckBox IsChecked="{Binding Use}" Checked="CheckBox_Checked" Unchecked="CheckBox_Checked"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcVariable">
                            <GridViewColumnHeader Content="Fält" ToolTipService.ToolTip="Välj vilken egenskap hos häst regeln ska gälla"/>
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <ComboBox x:Name="cmbVariable" MinWidth="100" ItemsSource="{Binding Path=Config.HorseVariableList,ElementName=ucGroupIntervalReduction}" SelectedItem="{Binding HorseVariable,Mode=TwoWay}" Tag="{Binding}" SelectionChanged="cmbVariable_SelectionChanged"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcNumberOfWinners">
                            <GridViewColumnHeader Content="Antal vinnare" ToolTipService.ToolTip="Klicka för att använda regel"/>
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <ItemsControl ItemsSource="{Binding NumberOfWinnersList}" Margin="2" ToggleButton.Checked="ItemsControl_Checked" ToggleButton.Unchecked="ItemsControl_Checked">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel Orientation="Horizontal"/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <CheckBox Template="{StaticResource CheckBoxTemplate}" 
                                                  Content="{Binding NumberOfWinners}" 
                                                  IsChecked="{Binding Selected}" 
                                                  IsEnabled="{Binding Selectable}"
                                                  FontSize="12"
                                                  Width="13"
                                                  Height="16"/>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcMinValue">
                            <GridViewColumnHeader Content="Min" ToolTipService.ToolTip="Välj vilken egenskap hos häst regeln ska gälla"/>
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <xctk:DecimalUpDown x:Name="dudMinValue" 
                                                       Minimum="{Binding Path=HorseVariable.GroupReductionInfo.MinValue}"
                                                       Maximum="{Binding Path=HorseVariable.GroupReductionInfo.MaxValue}"
                                                       Increment="{Binding Path=HorseVariable.GroupReductionInfo.Increment}"
                                                       Value="{Binding LowerBoundary}" ValueChanged="Dud_ValueChanged"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcMaxValue">
                            <GridViewColumnHeader Content="Max" ToolTipService.ToolTip="Välj vilken egenskap hos häst regeln ska gälla"/>
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <xctk:DecimalUpDown x:Name="dudMaxValue" 
                                                       Minimum="{Binding Path=HorseVariable.GroupReductionInfo.MinValue}"
                                                       Maximum="{Binding Path=HorseVariable.GroupReductionInfo.MaxValue}"
                                                       Increment="{Binding Path=HorseVariable.GroupReductionInfo.Increment}"
                                                       Value="{Binding UpperBoundary}" ValueChanged="Dud_ValueChanged"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcLegList">
                            <GridViewColumnHeader Content="Lopp" ToolTipService.ToolTip="Välj för vilka lopp regeln ska gälla"/>
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <ItemsControl ItemsSource="{Binding LegSelectionList}" ToggleButton.Checked="ItemsControl_Checked" ToggleButton.Unchecked="ItemsControl_Checked">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel Orientation="Horizontal"/>
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <CheckBox Template="{StaticResource CheckBoxTemplate}" 
                                                  Content="{Binding LegNumber}" 
                                                  IsChecked="{Binding Selected}" 
                                                  FontSize="12"
                                                  Width="13"
                                                  Height="16"/>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcShowHorses">
                            <GridViewColumnHeader ToolTipService.ToolTip="Klicka för att visa hästar som ingår i regeln"/>
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <Button x:Name="btnShowHorses" Content="Visa hästar" Click="btnShowHorses_Click"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcRemove">
                            <GridViewColumnHeader ToolTipService.ToolTip="Klicka för att ta bort regel"/>
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <Button x:Name="btnRemove" Content="Ta bort" Click="btnRemove_Click"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                    </GridView>
                </ListView.View>
            </ListView>

        </Grid>

    </Grid>
</HPT:UCMarkBetControl>
