<HPT:UCMarkBetControl x:Class="HPTClient.UCComplimentaryRules"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:HPT="clr-namespace:HPTClient"
    x:Name="ucComplimentaryRules"
    DataContextChanged="ucComplimentaryRules_DataContextChanged">
    <Grid>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition/>
        </Grid.RowDefinitions>
        
        <Grid.ColumnDefinitions>
            <ColumnDefinition/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <StackPanel Orientation="Horizontal" Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="2" HorizontalAlignment="Left">
            <StackPanel.Resources>
                <Style TargetType="{x:Type Border}">
                    <Setter Property="Margin" Value="2"/>
                    <Setter Property="BorderThickness" Value="1"/>
                    <Setter Property="BorderBrush" Value="DarkBlue"/>
                    <Setter Property="CornerRadius" Value="1"/>
                </Style>
            </StackPanel.Resources>

            <Border>
                <!--<CheckBox x:Name="chkUseReduction" IsChecked="{Binding Path=ComplementaryRulesCollection.Use}" VerticalAlignment="Center" Margin="3" 
                          Checked="chkUseReduction_Checked" Unchecked="chkUseReduction_Checked">-->
                <CheckBox x:Name="chkUseReduction" IsChecked="{Binding Path=ComplementaryRulesCollection.Use}" VerticalAlignment="Center" Margin="3">
                    <TextBlock Style="{StaticResource tbMediumStyle}" Text="Använd utgångar" FontSize="12"/>
                </CheckBox>
            </Border>

            <Border>
                <StackPanel Orientation="Horizontal">
                    <Button x:Name="btnNewRule" Content="Ny utgång"  Margin="2" Click="btnNewRule_Click" MinWidth="50" ToolTip="Skapa ny reduceringsregel"/>
                    <Button x:Name="btnRemoveAll" Content="Ta bort alla"  Margin="2" Click="btnRemoveAll_Click"  MinWidth="50" ToolTip="Rensa alla inställningar för vald reduceringsregel"/>
                </StackPanel>
            </Border>

            <Border>
                <StackPanel Orientation="Horizontal">

                    <TextBlock Style="{StaticResource tbMediumStyle}" Text="Antal utgångar" FontSize="12" Padding="2"/>

                    <ItemsControl x:Name="itNumberOfComplementaryRules" ItemsSource="{Binding Path=ComplementaryRulesCollection.NumberOfWinnersList}" 
                                  Margin="2" ToggleButton.Checked="itNumberOfComplementaryRules_Checked" ToggleButton.Unchecked="itNumberOfComplementaryRules_Checked">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Orientation="Horizontal"/>
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <CheckBox Template="{StaticResource CheckBoxTemplate}" 
                                                      Content="{Binding NumberOfWinners}" 
                                                      IsChecked="{Binding Selected}" 
                                                      IsEnabled="{Binding Selectable}"
                                                      FontSize="12"
                                                      Width="13"
                                                      Height="16"/>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </Border>

            <Border>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Style="{StaticResource tbMediumStyle}" Text="Utgångsmallar" FontSize="12" Margin="3"/>

                    <ComboBox x:Name="cmbTemplateList" Width="200" Margin="3">
                        <ComboBoxItem x:Name="cbiATGTillsammans" Content="ATG Tillsammans" Selected="cbiATGTillsammans_Selected"/>
                        <ComboBoxItem x:Name="cbiMarksNumberOne" Content="Insatsfavoriter" Selected="cbiMarksNumberOne_Selected"/>
                        <ComboBoxItem x:Name="cbiOddsNumberOne" Content="Oddsfavoriter" Selected="cbiOddsNumberOne_Selected"/>
                        <ComboBoxItem x:Name="cbiHomeHorses" Content="Hemmahästar" Selected="cbiHomeHorses_Selected"/>
                        <ComboBoxItem x:Name="cbiBackTrackHorse" Content="Bakspårshästar" Selected="cbiBackTrackHorse_Selected"/>
                        <ComboBoxItem x:Name="cbi1Or2Favourites" Content="2 storfavoriter, minst en vinnare" Selected="cbi1Or2Favourites_Selected"/>
                        <ComboBoxItem x:Name="cbi1Or2FavouritesOf3" Content="3 favoriter, 1-2 vinnare" Selected="cbi1Or2FavouritesOf3_Selected"/>
                        <ComboBoxItem x:Name="cbiEffectHorses" Content="Effekthästar" Selected="cbiEffectHorses_Selected"/>
                        <ComboBoxItem x:Name="cbiOddNumbers" Content="Udda nummer" Selected="cbiOddNumbers_Selected"/>
                        <ComboBoxItem x:Name="cbiEvenNumbers" Content="Jämna nummer" Selected="cbiEvenNumbers_Selected"/>
                        <ComboBoxItem x:Name="cbiNoShoes" Content="Barfota runt om" Selected="cbiNoShoes_Selected"/>
                        <ComboBoxItem x:Name="cbiShoesChanged" Content="Med skoändring(ar)" Selected="cbiShoesChanged_Selected"/>
                    </ComboBox>
                </StackPanel>
            </Border>

        </StackPanel>

        <HPT:UCRaceView BorderBrush="Black" BorderThickness="1" DataContext="{Binding ElementName=ucComplimentaryRules}" Grid.Column="0" Grid.Row="1" ToggleButton.Checked="UCRaceView_Checked" ToggleButton.Unchecked="UCRaceView_Checked"/>

        <GroupBox Background="{StaticResource BackgroundBrush}" HeaderTemplate="{StaticResource GroupBoxHeaderTemplate}" Header="Sparade utgångar" HorizontalAlignment="Stretch" Grid.Column="1"  Grid.Row="0" Grid.RowSpan="2">

            <!--<ListBox ItemsSource="{Binding Path=ComplementaryRulesCollection.ComplementaryReductionRuleList}" Margin="2">-->
            <ListBox ItemsSource="{Binding Path=ComplementaryRulesCollection.ReductionRuleList}" Margin="2">
                <ListBox.ItemsPanel>
                    <ItemsPanelTemplate>
                        <StackPanel Orientation="Vertical"/>
                    </ItemsPanelTemplate>
                </ListBox.ItemsPanel>
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <Expander ExpandDirection="Down">
                            <Expander.Header>

                                <Border BorderBrush="Black" BorderThickness="1" Margin="2" HorizontalAlignment="Stretch">
                                    <StackPanel Orientation="Horizontal" Background="{StaticResource BackgroundBrush}" HorizontalAlignment="Stretch">

                                        <!--<TextBlock Text="Antal vinnare" Style="{StaticResource tbStyle}" Margin="2" FontSize="12"/>-->
                                        <CheckBox x:Name="chkUseComplementaryRule" Margin="2" IsChecked="{Binding Path=Use}" HorizontalAlignment="Center" VerticalAlignment="Center">
                                            <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center" 
                                                FontFamily="Arial" FontSize="11" FontWeight="Bold" Text="Antal vinnare" />
                                        </CheckBox>

                                        <ItemsControl ItemsSource="{Binding NumberOfWinnersList}" Margin="2" ToggleButton.Checked="ItemsControl_Checked" ToggleButton.Unchecked="ItemsControl_Checked">
                                            <ItemsControl.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <StackPanel Orientation="Horizontal"/>
                                                </ItemsPanelTemplate>
                                            </ItemsControl.ItemsPanel>
                                            <ItemsControl.ItemTemplate>
                                                <DataTemplate>
                                                    <CheckBox Template="{StaticResource CheckBoxTemplate}" 
                                                              Content="{Binding NumberOfWinners}" 
                                                              IsChecked="{Binding Selected}" 
                                                              IsEnabled="{Binding Selectable}"
                                                              FontSize="12"
                                                              Width="13"
                                                              Height="16"/>
                                                </DataTemplate>
                                            </ItemsControl.ItemTemplate>
                                        </ItemsControl>

                                        <Button x:Name="btnSelect" MinWidth="50" Content="Välj"  Margin="2" Click="btnSelect_Click"/>
                                        
                                        <Button x:Name="btnRemove" MinWidth="50" Content="Ta bort"  Margin="2" Click="btnRemove_Click"/>

                                    </StackPanel>
                                </Border>
                            </Expander.Header>

                            <ListBox ItemsSource="{Binding Path=HorseList}" ScrollViewer.VerticalScrollBarVisibility="Auto" MaxHeight="180" BorderThickness="0" Background="{StaticResource BackgroundBrush}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <StackPanel Orientation="Vertical"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Margin="2">
                                            <TextBlock Text="{Binding Path=ParentRace.LegNrString}" Style="{StaticResource tbStyle}" FontWeight="Bold" Padding="1,1,4,1"/>
                                            <CheckBox Name="chkNrSelect" IsEnabled="{Binding NotScratched}" IsChecked="{Binding Selected}" Template="{StaticResource CheckBoxControlTemplate}" Content="{Binding StartNr}" Padding="3,0"/>
                                            <TextBlock Text="{Binding HorseName}" Style="{StaticResource tbStyle}" Padding="4,1,1,1"/>
                                        </StackPanel>
                                        <!--<TextBlock Text="{Binding HorseName}" Style="{StaticResource tbStyle}" Margin="2"/>-->
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ListBox>

                        </Expander>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </GroupBox>

    </Grid>
</HPT:UCMarkBetControl>
