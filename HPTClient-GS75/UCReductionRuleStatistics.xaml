<HPT:UCMarkBetControl x:Class="HPTClient.UCReductionRuleStatistics"             
    xmlns:HPT="clr-namespace:HPTClient"
                      x:Name="ucReductionRuleStatistics"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             d:DesignHeight="500" d:DesignWidth="800">
    <UserControl.Resources>
        
    </UserControl.Resources>
    
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <GroupBox x:Name="gbSystemStatistics" Background="{StaticResource BackgroundBrush}" HeaderTemplate="{StaticResource GroupBoxHeaderCheckBoxTemplate}" BorderBrush="Black" MinWidth="200" MaxWidth="300">
            <GroupBox.Header>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Systemstatistik" Padding="2"/>
                    <Button x:Name="btnCalculateSystemStatistics" Content="Beräkna" Click="btnCalculateSystemStatistics_Click" MaxWidth="120" HorizontalAlignment="Left" Padding="1"/>
                </StackPanel>
            </GroupBox.Header>
            <Grid Grid.Row="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>

                <TextBlock Text="Ramsystemets sannolikhet" FontWeight="Bold" Grid.Row="1" Margin="3,1"/>
                <TextBlock Text="{Binding SystemProbability,StringFormat=P1}" Grid.Row="1" Grid.Column="1"/>

                <TextBlock Text="Reducerat systems sannolikhet" FontWeight="Bold" Grid.Row="2" Margin="3,1"/>
                <TextBlock Text="{Binding ReducedSystemProbability,StringFormat=P1}" Grid.Row="2" Grid.Column="1"/>

                <TextBlock Text="Sannolikhetskvot" FontWeight="Bold" Grid.Row="3" Margin="3,1"/>
                <TextBlock Text="{Binding SystemProbabilityRatio,StringFormat=P1}" Grid.Row="3" Grid.Column="1"/>

            </Grid>
        </GroupBox>

        <GroupBox x:Name="gbJackpotStatistics" Grid.Row="1" Background="{StaticResource BackgroundBrush}" Visibility="{Binding MultiplePoolsVisibility}"
                  HeaderTemplate="{StaticResource GroupBoxHeaderCheckBoxTemplate}" BorderBrush="Black" MinWidth="200" MaxWidth="300">
            <GroupBox.Header>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Jackpottstatistik" Padding="2"/>
                    <Button x:Name="btnCalculateJackpotStatistics" Content="Beräkna" Click="btnCalculateJackpotStatistics_Click" MaxWidth="120" HorizontalAlignment="Left"  Padding="1"/>
                </StackPanel>
            </GroupBox.Header>
            
            <Grid Grid.Row="0" Grid.Column="2" Margin="12,0,0,0" Visibility="{Binding MultiplePoolsVisibility}">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="200"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                    <RowDefinition/>
                </Grid.RowDefinitions>

                <TextBlock Text="Risk/chans för jackpott" FontWeight="Bold" Grid.Row="1" Margin="3,1"/>
                <TextBlock Text="{Binding JackpotProbability,StringFormat=P1}" Grid.Row="1" Grid.Column="1"/>

                <TextBlock Text="Antal jackpottrader vid 1 fel" FontWeight="Bold" Grid.Row="2" Margin="3,1"/>
                <TextBlock Text="{Binding JackpotRowsOneError,StringFormat=N0,ConverterCulture=sv-SE}" Grid.Row="2" Grid.Column="1"/>

                <TextBlock Text="Antal jackpottrader vid 2 fel" FontWeight="Bold" Grid.Row="3" Margin="3,1"/>
                <TextBlock Text="{Binding JackpotRowsTwoErrors,StringFormat=N0,ConverterCulture=sv-SE}" Grid.Row="3" Grid.Column="1"/>

            </Grid>
        </GroupBox>


        <GroupBox x:Name="gbRowValueStatistics" Grid.RowSpan="2" Grid.Column="1" Background="{StaticResource BackgroundBrush}"
                  HeaderTemplate="{StaticResource GroupBoxHeaderCheckBoxTemplate}" BorderBrush="Black">
            <GroupBox.Header>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="Radvärdesstatistik" Padding="2"/>
                    <Button x:Name="btnCalculateRowValueStatistics" Content="Beräkna" Click="btnCalculateRowValueStatistics_Click" MaxWidth="120" HorizontalAlignment="Left" Padding="1"/>
                </StackPanel>
            </GroupBox.Header>

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBlock Text="Radvärdesintervall" FontWeight="Bold" Margin="3,1"/>
                <ItemsControl ItemsSource="{Binding Path=BetType.RowValuePercentileList}" Grid.Row="1">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Vertical"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal" Margin="2">
                                <TextBlock Width="80" Text="{Binding Path=Description}"/>
                                <TextBlock Width="60" Text="{Binding Path=RowValue,StringFormat=N0,ConverterCulture=sv-SE}" FontStyle="Italic" TextAlignment="Right"/>
                            </StackPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                    
                </ItemsControl>

                <Border Width="1" Background="Black" Grid.RowSpan="2" Grid.Column="1" Margin="10,3,7,1"/>

                <TextBlock Text="Radvärdesfördelning" FontWeight="Bold" Margin="3,1" Grid.Column="2"/>
                <ItemsControl ItemsSource="{Binding Path=BetType.RowValueIntervalList}" Grid.Row="1" Grid.Column="2" Margin="3,1">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Vertical"/>
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>

                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Width="60" Text="{Binding Path=LowerLimit,StringFormat=N0,ConverterCulture=sv-SE}" TextAlignment="Right"/>
                                <TextBlock Text=" - "/>
                                <TextBlock Width="60" Text="{Binding Path=UpperLimit,StringFormat=N0,ConverterCulture=sv-SE}" TextAlignment="Right"/>
                                <TextBlock Width="100" FontStyle="Italic" TextAlignment="Right">
                                    <TextBlock.Text>
                                        <MultiBinding StringFormat="{}{0:N0} ({1:P2})" ConverterCulture="sv-SE">
                                            <Binding Path="NumberOfRows"/>
                                            <Binding Path="PercentageOfRows"/>
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </StackPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>

                </ItemsControl>

            </Grid>
        </GroupBox>

        <Grid Grid.Row="2" Grid.ColumnSpan="3" Width="Auto" Height="Auto">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <StackPanel Orientation="Horizontal" Margin="1,9,1,1">

                <TextBlock Text="Information om reduceringsvillkor" FontWeight="Bold" FontSize="14" Margin="3"/>
                <Button x:Name="btnCalculateReductionRuleStatistics" Content="Beräkna" Click="btnCalculateReductionRuleStatistics_Click" MaxWidth="120" HorizontalAlignment="Left"/>

            </StackPanel>

            <ListView x:Name="lvwReductionRuleStatistics" ItemsSource="{Binding ReductionRuleStatisticsList}" Grid.Row="1" ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto">
                <ListView.View>
                    <GridView x:Name="gvwReductionRuleStatistics">

                        <GridViewColumn x:Name="gvcReductionName" Header="Reduceringstyp">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding ReductionTypeString}"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcReductionSpecification" Header="Reduceringsvillkor">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding ReductionSpecificationString}"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcRemaingRows" Header="Kvarvarande rader" Width="100">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock TextAlignment="Right" HorizontalAlignment="Right">
                                        <TextBlock.Text>
                                            <MultiBinding StringFormat="{}{0:N0} ({1:P1})" ConverterCulture="sv-SE">
                                                <Binding Path="RemainingRows"/>
                                                <Binding Path="RemainingRowsPercentage"/>
                                            </MultiBinding>
                                        </TextBlock.Text>
                                    </TextBlock>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcReductionProbability" Header="Sannolikhet" Width="50">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Probability,StringFormat=P1}"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcReductionToProbabilityRatio" Header="Kvot" Width="50">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding ProbabilityRelative,StringFormat=P1}"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcResultAsString" Header="Resultat">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding RuleResultForCorrectRow}"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcNumberOfAllCorrect" Header="Alla rätt" Width="50">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding NumberOfAllCorrect,StringFormat=N0,ConverterCulture=sv-SE}"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcNumberOfOneError" Header="1 fel" Width="50">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding NumberOfOneError,StringFormat=N0,ConverterCulture=sv-SE}"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <GridViewColumn x:Name="gvcNumberOfTwoErrors" Header="2 fel" Width="50">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding NumberOfTwoErrors,StringFormat=N0,ConverterCulture=sv-SE}"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>

                        <!--<GridViewColumn x:Name="gvcHighestValue" Header="Högsta värde">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock TextAlignment="Right" HorizontalAlignment="Right">
                                    <TextBlock.Text>
                                        <MultiBinding StringFormat="{}{0:## ### ##0} ({1:## ### ##0})">
                                            <Binding Path="HighestIncludedSum"/>
                                            <Binding Path="HighestSum"/>
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <GridViewColumn x:Name="gvcMin" Header="Minimum">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <xctk:IntegerUpDown Increment="{Binding IncrementLower}" Value="{Binding MinSum}" 
                                                   Minimum="{Binding Path=LowestSum,Mode=OneTime}" 
                                                   Maximum="{Binding Path=HighestSum,Mode=OneTime}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <GridViewColumn x:Name="gvcMax" Header="Maximum">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <xctk:IntegerUpDown Increment="{Binding IncrementUpper}" Value="{Binding MaxSum}" 
                                                   Minimum="{Binding Path=LowestSum,Mode=OneTime}" 
                                                   Maximum="{Binding Path=HighestSum,Mode=OneTime}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <GridViewColumn x:Name="gvcMinPercent" Header="Minimum (%)">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <xctk:IntegerUpDown Increment="5" Value="{Binding MinPercentSum}" 
                                                   Minimum="0" Maximum="100"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>

                    <GridViewColumn x:Name="gvcMaxPercent" Header="Maximum (%)">
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <xctk:IntegerUpDown Increment="5" Value="{Binding MaxPercentSum}" 
                                                   Minimum="0" Maximum="100"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>-->

                    </GridView>
                </ListView.View>
            </ListView>

        </Grid>
        
    </Grid>
</HPT:UCMarkBetControl>
